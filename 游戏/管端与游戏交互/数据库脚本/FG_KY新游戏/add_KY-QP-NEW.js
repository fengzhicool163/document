var games = [{
    "_id": NumberInt(261),
    "name": "开元-二人麻将",
    "alias": "ky-ermj",
    "icon": "/common/gameIcon/ky/ermj.png",
    "url": "../s004_ermj/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1261),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "740",
    "classifyAlias" : "ky-ermj", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(1), 
    "classifyIcon" : "/common/gameIcon/ky/ermj.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(262),
    "name": "开元-看牌抢庄牛牛",
    "alias": "ky-kpqznn",
    "icon": "/common/gameIcon/ky/kpqznn.png",
    "url": "../s004_fg-kpqznn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1262),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "890",
    "classifyAlias" : "ky-kpqznn", 
    "classifyStatus" : "NORMAL",
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(2), 
    "classifyIcon" : "/common/gameIcon/ky/kpqznn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(263),
    "name": "开元-金鲨银鲨",
    "alias": "ky-jsys",
    "icon": "/common/gameIcon/ky/jsys.png",
    "url": "../jsys/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1263),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1940",
    "classifyAlias" : "ky-jsys", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/jsys.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(264),
    "name": "开元-奔驰宝马",
    "alias": "ky-bcbm",
    "icon": "/common/gameIcon/ky/bcbm.png",
    "url": "../bcbm/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1264),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1960",
    "classifyAlias" : "ky-bcbm", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/bcbm.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(265),
    "name": "开元-百人骰宝",
    "alias": "ky-brtb",
    "icon": "/common/gameIcon/ky/brtb.png",
    "url": "../brtb/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1265),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1980",
    "classifyAlias" : "ky-brtb", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/brtb.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(266),
    "name": "开元-押宝抢庄牛牛",
    "alias": "ky-ybqznn",
    "icon": "/common/gameIcon/ky/ybqznn.png",
    "url": "../ybqznn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1266),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1850",
    "classifyAlias" : "ky-ybqznn", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/ybqznn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(267),
    "name": "开元-单挑牛牛",
    "alias": "ky-dtnn",
    "icon": "/common/gameIcon/ky/dtnn.png",
    "url": "../dtnn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1267),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1810",
    "classifyAlias" : "ky-dtnn", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/dtnn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(268),
    "name": "开元-炸金牛",
    "alias": "ky-zjn",
    "icon": "/common/gameIcon/ky/zjn.png",
    "url": "../zjn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1268),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1990",
    "classifyAlias" : "ky-zjn", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/zjn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(269),
    "name": "开元-红包捕鱼",
    "alias": "ky-hbby",
    "icon": "/common/gameIcon/ky/hbby.png",
    "url": "../hbby/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(1269),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "510",
    "classifyAlias" : "ky-hbby", 
    "classifyStatus" : "NORMAL", 
	"enterLimit" : NumberInt(10),
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "/common/gameIcon/ky/hbby.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
}
];


// 删除基本表中的游戏数据
function removeOldData(oldGameName){
	db.brand.update({},{$pull: {"games": {"gameName":oldGameName} }},{multi:true});
	db.base_game_config.remove({"name":oldGameName},false);
}

/*初始化业主游戏信息*/
function initBrandGameInfo(gameId) {
    var brandList = db.brand.distinct("brand");
    print("现有游戏业主: " + brandList);
    print("开始初始化业主游戏信息");

    for (var i = 0; i < brandList.length; i++) {
        var brand = brandList[i];
        var gameInfo = db.base_game_config.findOne({ _id: gameId });
        var brandGameInfo = {};
        brandGameInfo.gameId = NumberInt(gameInfo._id);
        brandGameInfo.gameName = gameInfo.name;
        brandGameInfo.state = "NORMAL";
        brandGameInfo.sort = NumberInt(gameInfo.sort);
		brandGameInfo.classify = NumberInt(gameInfo.classify);
		brandGameInfo.classifyStatus = gameInfo.classifyStatus;
		brandGameInfo.classifyGameIds = gameInfo.classifyGameIds;
		brandGameInfo.gamePlatform = gameInfo.gamePlatform;
		brandGameInfo.classifyOnlineFlag = gameInfo.classifyOnlineFlag;
		brandGameInfo.classifySort = NumberInt(gameInfo.classifySort);
		brandGameInfo.enterLimit = NumberInt(gameInfo.enterLimit);
        brandGameInfo.createTime = new Date();
        brandGameInfo.updateTime = new Date();
        brandGameInfo.rooms = [];
        print("插入对应的游戏数据");
        printjson(brandGameInfo);
        db.brand.update({ "brand": brand }, { $addToSet: { "games": brandGameInfo } });
    }
}

db.base_game_config.insert(games);

games.forEach(game => {
    initBrandGameInfo(game._id);
});