var games = [{
    "_id": NumberInt(201),
    "name": "开元-血流成河",
    "alias": "ky-xlch",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/xlch.png",
    "url": "../s004_xlch/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(861),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "650",
    "classifyAlias" : "xlch-ky", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(1), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/xlch.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(202),
    "name": "开元-森林舞会",
    "alias": "ky-slwh",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/slwh.png",
    "url": "../s004_slwh/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(862),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "920",
    "classifyAlias" : "ky-slwh", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(2), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/slwh.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(203),
    "name": "开元-百人牛牛",
    "alias": "ky-brnn",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/brnn.png",
    "url": "../s004_brnn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(863),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "930",
    "classifyAlias" : "ky-brnn", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/brnn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(204),
    "name": "开元-炸金花",
    "alias": "ky-zjh",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/zjh.png",
    "url": "../s004_brnn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(864),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "220",
    "classifyAlias" : "ky-zjh", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(4), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/zjh.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(205),
    "name": "开元-德州扑克",
    "alias": "ky-dzpk",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/dzpk.png",
    "url": "../s004_ky-dzpk/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(865),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "620",
    "classifyAlias" : "ky-dzpk", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(5), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/dzpk.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(206),
    "name": "开元-抢庄牛牛",
    "alias": "ky-qznn",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/qznn.png",
    "url": "../s004_ky-qznn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(866),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "830",
    "classifyAlias" : "ky-qznn", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(6), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/qznn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(207),
    "name": "开元-万人炸金花",
    "alias": "ky-wrzjh",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/wrzjh.png",
    "url": "../s004_ky-wrzjh/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(867),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "1950",
    "classifyAlias" : "ky-wrzjh", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(7), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/wrzjh.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(208),
    "name": "开元-极速炸金花",
    "alias": "ky-jszjh",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/jszjh.png",
    "url": "../s004_ky-jszjh/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(868),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "230",
    "classifyAlias" : "ky-jszjh", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(8), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/jszjh.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(209),
    "name": "开元-幸运五张",
    "alias": "ky-xywz",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/xywz.png",
    "url": "../s004_ky-xywz/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(869),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "380",
    "classifyAlias" : "ky-xywz", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(9), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/xywz.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(210),
    "name": "开元-21点",
    "alias": "ky-21d",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/21d.png",
    "url": "../s004_ky-21d/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(870),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "600",
    "classifyAlias" : "ky-21d", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(10), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/21d.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(211),
    "name": "开元-斗地主",
    "alias": "ky-ddz",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/ddz.png",
    "url": "../s004_ky-ddz/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(871),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "610",
    "classifyAlias" : "ky-ddz", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(11), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/ddz.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(212),
    "name": "开元-十三水",
    "alias": "ky-sss",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/sss.png",
    "url": "../s004_ky-sss/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(872),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "630",
    "classifyAlias" : "ky-sss", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(12), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/sss.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(213),
    "name": "开元-二八杠",
    "alias": "ky-ebg",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/ebg.png",
    "url": "../s004_ky-ebg/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(873),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "720",
    "classifyAlias" : "ky-ebg", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(13), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/ebg.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(214),
    "name": "开元-抢庄牌九",
    "alias": "ky-qzpj",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/qzpj.png",
    "url": "../s004_ky-qzpj/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(874),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "730",
    "classifyAlias" : "ky-qzpj", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(14), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/ebg.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(215),
    "name": "开元-三公",
    "alias": "ky-sg",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/sg.png",
    "url": "../s004_ky-sg/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(875),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "860",
    "classifyAlias" : "ky-sg", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(15), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/sg.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(216),
    "name": "开元-通比牛牛",
    "alias": "ky-tbnn",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/tbnn.png",
    "url": "../s004_ky-tbnn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(876),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "870",
    "classifyAlias" : "ky-tbnn", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(16), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/tbnn.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(217),
    "name": "开元-押庄龙虎",
    "alias": "ky-yzlh",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/yzlh.png",
    "url": "../s004_ky-yzlh/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(877),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "900",
    "classifyAlias" : "ky-yzlh", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(17), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/yzlh.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(218),
    "name": "开元-百家乐",
    "alias": "ky-bjl",
    "icon": "https://media.wpstyles.com/common/gameIcon/ky/bjl.png",
    "url": "../s004_ky-bjl/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(878),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "KY",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "910",
    "classifyAlias" : "ky-bjl", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(18), 
    "classifyIcon" : "https://media.wpstyles.com/common/gameIcon/ky/bjl.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
}
];


// 删除基本表中的游戏数据
function removeOldData(oldGameName){
	db.brand.update({},{$pull: {"games": {"gameName":oldGameName} }},{multi:true});
	db.base_game_config.remove({"name":oldGameName},false);
}

/*初始化业主游戏信息*/
function initBrandGameInfo(gameId) {
    var brandList = db.brand.distinct("brand");
    print("现有游戏业主: " + brandList);
    print("开始初始化业主游戏信息");

    for (var i = 0; i < brandList.length; i++) {
        var brand = brandList[i];
        var gameInfo = db.base_game_config.findOne({ _id: gameId });
        var brandGameInfo = {};
        brandGameInfo.gameId = NumberInt(gameInfo._id);
        brandGameInfo.gameName = gameInfo.name;
        brandGameInfo.state = "NORMAL";
        brandGameInfo.sort = NumberInt(gameInfo.sort);
		brandGameInfo.classify = NumberInt(gameInfo.classify);
		brandGameInfo.classifyStatus = gameInfo.classifyStatus;
		brandGameInfo.classifyGameIds = gameInfo.classifyGameIds;
		brandGameInfo.gamePlatform = gameInfo.gamePlatform;
		brandGameInfo.classifyOnlineFlag = gameInfo.classifyOnlineFlag;
        brandGameInfo.createTime = new Date();
        brandGameInfo.updateTime = new Date();
        brandGameInfo.rooms = [];
        print("插入对应的游戏数据");
        printjson(brandGameInfo);
        db.brand.update({ "brand": brand }, { $addToSet: { "games": brandGameInfo } });
    }
}

db.base_game_config.insert(games);

games.forEach(game => {
    initBrandGameInfo(game._id);
});