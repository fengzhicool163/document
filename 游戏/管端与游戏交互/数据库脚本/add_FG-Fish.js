var games = [{
    "_id": NumberInt(221),
    "name": "FG-捕鱼来了3D",
    "alias": "fg-fish_3D",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/fish_3D.png",
    "url": "../s004_fish_3D/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(881),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_3D",
    "classifyAlias" : "fg-fish_3D", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(1), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/fish_3D.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(222),
    "name": "FG-魔法王者",
    "alias": "fg-fish_mfwz",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/fish_mfwz.png",
    "url": "../s004_fish_mfwz/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(882),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_mfwz",
    "classifyAlias" : "fg-fish_mfwz", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(2), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/fish_mfwz.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(223),
    "name": "FG-捕鸟达人",
    "alias": "fg-fish_bn",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/bndr.png",
    "url": "../s004_fg-fish_bn/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(883),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_bn",
    "classifyAlias" : "fg-fish_bn", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(3), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/bndr.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(224),
    "name": "FG-欢乐捕鱼",
    "alias": "fg-fish_hl",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/hlby.png",
    "url": "../s004_fish_hl/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(884),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_hl",
    "classifyAlias" : "fg-fish_hl", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(4), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/hlby.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(225),
    "name": "FG-美人捕鱼",
    "alias": "fg-fish_mm",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/mrby.png",
    "url": "../s004_fish_mm/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(885),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_mm",
    "classifyAlias" : "fg-fish_mm", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(5), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/mrby.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(226),
    "name": "FG-天天捕鱼",
    "alias": "fg-fish_tt",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/ttby.png",
    "url": "../s004_fish_tt/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(886),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_tt",
    "classifyAlias" : "fg-fish_tt", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(6), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/ttby.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
},
{
    "_id": NumberInt(227),
    "name": "FG-雷霆战警",
    "alias": "fg-fish_zj",
    "icon": "https://media.lytfhg.com/common/gameIcon/fg/mobile/ltzj.png",
    "url": "../s004_fg-fish_zj/",
    "jumpUrl": true,
    "gameStyle": "CARD_GAME",
    "state": "NORMAL",
    "sort": NumberInt(887),
    "retryConnection": false,
    "createTime": new Date(),
    "updateTime": new Date(),
    "rooms":[],
	"gamePlatform": "FG",
	"classify" : NumberInt(3), 
	"classifyThirdGameId": "fish_zj",
    "classifyAlias" : "fg-fish_zj", 
    "classifyStatus" : "NORMAL", 
    "classifySort" : NumberInt(7), 
    "classifyIcon" : "https://media.lytfhg.com/common/gameIcon/fg/mobile/ltzj.png",
	"classifyGameIds" : "", 
    "classifyGames" : [], 
    "classifyOnlineFlag" : true
}
];


// 删除基本表中的游戏数据
function removeOldData(oldGameName){
	db.brand.update({},{$pull: {"games": {"gameName":oldGameName} }},{multi:true});
	db.base_game_config.remove({"name":oldGameName},false);
}

/*初始化业主游戏信息*/
function initBrandGameInfo(gameId) {
    var brandList = db.brand.distinct("brand");
    print("现有游戏业主: " + brandList);
    print("开始初始化业主游戏信息");

    for (var i = 0; i < brandList.length; i++) {
        var brand = brandList[i];
        var gameInfo = db.base_game_config.findOne({ _id: gameId });
        var brandGameInfo = {};
        brandGameInfo.gameId = NumberInt(gameInfo._id);
        brandGameInfo.gameName = gameInfo.name;
        brandGameInfo.state = "NORMAL";
        brandGameInfo.sort = NumberInt(gameInfo.sort);
		brandGameInfo.classify = NumberInt(gameInfo.classify);
		brandGameInfo.classifyStatus = gameInfo.classifyStatus;
		brandGameInfo.classifyGameIds = gameInfo.classifyGameIds;
		brandGameInfo.gamePlatform = gameInfo.gamePlatform;
		brandGameInfo.classifyOnlineFlag = gameInfo.classifyOnlineFlag;
		brandGameInfo.classifySort = NumberInt(gameInfo.classifySort);
        brandGameInfo.createTime = new Date();
        brandGameInfo.updateTime = new Date();
        brandGameInfo.rooms = [];
        print("插入对应的游戏数据");
        printjson(brandGameInfo);
        db.brand.update({ "brand": brand }, { $addToSet: { "games": brandGameInfo } });
    }
}

db.base_game_config.insert(games);

games.forEach(game => {
    initBrandGameInfo(game._id);
});